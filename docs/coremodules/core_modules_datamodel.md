# VMF Core Modules Data Model #

This document captures all of the data fields in storage that are written by the VMF Core Modules.  For a detailed view of the data needs of each module, see the class level documentation (generated by Doxygen).

* [Input Generation Related Data Fields](#input-generation-related-data-fields)
* [Execution Related Data Fields](#execution-related-data-fields)
* [Distributed Fuzzing Related Data Fields](#distributed-fuzzing-related-data-fields)
* [Metadata Fields](#metadata-fields)

## Input Generation Related Data Fields
|Field Name|Type|Description|Written-By|
|---|---|---|---|
|MUTATOR_ID|INT|Used by MOPTInputGenerator to track which mutator was responsible for creating a particular test case.|MOPTInputGenerator|
|REDPAWN_NEW_COVERAGE|TAG|Used by RedPawnInputGenerator to keep track of the test cases that still need to be analyzed.|RedPawnInputGenerator|
|TEST_CASE|BUFFER|The primary test case data buffer (i.e. the test case that the executor will execute).|InitializationModules, InputGenerationModules|
|TEST_CASE_AUT|BUFFER|An automata representation of the grammer used to generate the test case.  This is used by the gramatron mutators modules for subsequent mutations of the test case.|GramatronBasedSeedGen, GramatronGenerateMutator|

## Execution Related Data Fields
|Field Name|Type|Description|Written-By|
|---|---|---|---|
|AFL_TRACE_BITS|BUFFER_TEMP|AFL++-style coverage bits for a particular test case (these bits have been "classified" using the AFL++ algorithm).|AFlForkserverExecutor (optionally)|
|CMPLOG_MAP_BITS|BUFFER_TEMP|AFL++-style CmpLog data for a particular test case.|AFLForkserverExecutor (optionally)|
|COVERAGE_COUNT|UINT|A numeric representation of how much coverage was achieved by this test case.  Higher numbers indicate more coverage.|AFLForkserverExecutor|
|CRASHED|TAG|This tag is set when the test case caused the SUT to crash.|AFLForkserverExecutor|
|EXEC_TIME_US|UINT|The execution time for the test case in microseconds (us).|AFLForkserverExecutor|
|FAVORED|TAG|This tag is used by AFLFavoredFeedback to track the currently "favored" test cases.|AFLFavoredFeedback|
|FITNESS|FLOAT|A numeric representation of how good a particular test case is.  This field is used to sort the test cases in storage.|AFLFeedback, AFLFavoredFeedback|
|HAS_NEW_COVERAGE|TAG|This tag is set when the test case caused new code coverage within the SUT.|AFLForkserverExecutor|
|HUNG|TAG|This tag is set when the test case caused the SUT to hang.|AFLForkserverExecutor|
|RAN_SUCCESSFULLY|TAG|This tag is set when the test case ran normally (i.e. did not crash or hang). This is useful so that input generators can select just from the normally executing test cases.|AFLForkserverExecutor|

## Distributed Fuzzing Related Data Fields


|Field Name|Type|Description|Written-By|
|---|---|---|---|
|FILE_URL|BUFFER|The URL of a test case as specified by CDMS.  This is needed when minimizing the corpus, in order to tell the CDMS which test cases to delete.|ServerCorpusInitialization (optionally)|
|SEND_TO_SERVER|TAG|Used by the ServerCorpusOutput module to manage the set of test cases that should be sent to the server at any given point in time.|ServerCorpusOutput|
|SERVER_TC|TAG|This tag is set on all test cases that are provided by CDMS, so that VMF does not send these test cases back to the server again.|CDMSCommandAndCorpusHandler|

*Note: ControllerModulePattern, ServerSeedInit, and ServerCorpusInitialization register for all data fields that CDMSCommandAndCorpusHandler uses (as this is a helper class for those modules).*

## Metadata Fields
The VMF Core Modules primarily use metadata fields to collect high-level metrics about the performance of the fuzzer for the purposes out outputting these fields for the operator (e.g. via StatsOutput, LoggerMetadataOutput, or CSVMetadataOutput).

|Field Name|Type|Description|Written-By|
|---|---|---|---|
|AVERAGE_EXEC_PER_SEC|FLOAT|The average number of test cases being executed per second by the fuzzer (over the whole fuzzing run).|ComputeStats|
|LATEST_EXEC_PER_SEC|FLOAT|The current number of test cases being executed per second by the fuzzer (in the last pass through the fuzzing loop).|ComputeStats|
|SECONDS_SINCE_LAST_UNIQUE_FINDING|FLOAT|The number of seconds since the last unique interesting test case was found (i.e. a new test case saved to long term storage).|ComputeStats|
|TOTAL_BYTES_COVERED|UINT|A count of the total code coverage achieved by the fuzzer.  This number increases as new parts of the code are discovered.|AFLForkserverExecutor|
|TOTAL_CRASHED_CASES|UINT|The total number of crashing test cases (test cases that were tagged with the CRASHED tag).|ComputeStats|
|TOTAL_HUNG_CASES|UINT|The total number of hanging test cases (test cases that were tagged with the HUNG tag).|ComputeStats|
|TOTAL_TEST_CASES|ULONG|The number of test cases that have been executed by the fuzzer.|ComputeStats|
|UNIQUE_CRASHED_CASES|UINT|A count of the number of unique crashing test cases (test cases saved to long term storage that have the CRASHED tag).|ComputeStats|
|UNIQUE_HUNG_CASES|UINT|A count of the number of unique hanging test cases (test cases saved to long term storage that have the HUNG tag).|ComputeStats|
|UNIQUE_TEST_CASES|UINT|A count of the number of unique test cases (test cases saved to long term storage, regardless of tag.|ComputeStats|



